[
    {
        "expected": {},
        "track": [
            "people"
        ],
        "next": [
            {
                "track": [
                    "humans"
                ],
                "expected": [],
                "uniqs": [
                    "name"
                ],
                "next": [
                    {
                        "level": 20,
                        "action": "addHuman",
                        "title": "Добавлен новый участник $name",
                        "method": "push",
                        "value": {
                            "w": "{@setNewWid()}",
                            "ts": "{ts}",
                            "name": "{name}",
                            "notes": "{?notes}",
                            "ufp1": "{?ufp1}",
                            "ufp2": "{?ufp2}",
                            "isMan": "{isMan}",
                            "bDay": "{bDay}",
                            "isInactive": "{?isInactive}"
                        },
                        "args": {
                            "ts": "#Number",
                            "name": "#String",
                            "notes": "#string",
                            "ufp1": "#number",
                            "ufp2": "#number",
                            "bDay": "#Number",
                            "isMan": "#Boolean",
                            "isInactive": "#boolean"
                        }
                    },
                    {
                        "level": 20,
                        "action": "addManyHumans",
                        "setForceInEach": {
                            ".": {
                                "w": "{@setNewWid()}"
                            }
                        },
                        "title": "Добавлено несколько участников",
                        "method": "concat",
                        "args": {
                            "value": "#List"
                        }
                    },
                    {
                        "track": [
                            [
                                "w",
                                "===",
                                "{wid}"
                            ]
                        ],
                        "next": [
                            {
                                "level": 20,
                                "track": [
                                    "name"
                                ],
                                "action": "setHumanName",
                                "title": "Изменено имя участника \"$prev\" на \"$value\"",
                                "method": "set",
                                "args": {
                                    "value": "#String"
                                }
                            },
                            {
                                "level": 20,
                                "track": [
                                    "ufp1"
                                ],
                                "action": "setHumanUfp1",
                                "title": "Изменено значение Уровня физ. подготовки (1) участника \"$humann\"",
                                "method": "set",
                                "args": {
                                    "value": "#Number",
                                    "humann": "#String"
                                }
                            },
                            {
                                "level": 20,
                                "track": [
                                    "ufp2"
                                ],
                                "action": "setHumanUfp2",
                                "title": "Изменено значение Уровня физ. подготовки (2) участника \"$humann\"",
                                "method": "set",
                                "args": {
                                    "value": "#Number",
                                    "humann": "#String"
                                }
                            },
                            {
                                "level": 20,
                                "track": [
                                    "isMan"
                                ],
                                "action": "setHumanIsMan",
                                "title": "Изменено значение пола участника \"$humann\"",
                                "method": "set",
                                "args": {
                                    "value": "#Boolean",
                                    "humann": "#String"
                                }
                            },
                            {
                                "level": 20,
                                "track": [
                                    "notes"
                                ],
                                "action": "setHumanNotes",
                                "title": "Изменена заметка участника \"$humann\"",
                                "method": "set",
                                "args": {
                                    "value": "#String",
                                    "humann": "#String"
                                }
                            },
                            {
                                "level": 20,
                                "track": [
                                    "bDay"
                                ],
                                "action": "setHumanBDay",
                                "title": "Изменена дата рождения \"$humann\"",
                                "method": "set",
                                "args": {
                                    "value": "#Number",
                                    "humann": "#String"
                                }
                            },
                            {
                                "level": 20,
                                "track": [
                                    "group"
                                ],
                                "action": "setHumanGroup",
                                "title": "Изменена группа \"$humann\"",
                                "method": "set",
                                "args": {
                                    "value": "#Number",
                                    "humann": "#String"
                                }
                            },
                            {
                                "level": 20,
                                "track": [
                                    "isInactive"
                                ],
                                "action": "setHumanInactive",
                                "title": "Участник \"$humann\" исключён",
                                "method": "set",
                                "args": {
                                    "value": "#Boolean",
                                    "humann": "#String"
                                }
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "track": [
            "games"
        ],
        "expected": {},
        "next": [
            {
                "track": [
                    "teamGames"
                ],
                "expected": [],
                "next": [
                    {
                        "uniqs": [
                            "ts"
                        ],
                        "level": 30,
                        "action": "addTeamGame",
                        "title": "Добавлена новая командная игра $name",
                        "method": "push",
                        "value": {
                            "w": "{@setNewWid()}",
                            "owner": "{@userLogin}",
                            "fio": "{@userFio}",
                            "ts": "{ts}",
                            "name": "{name}",
                            "teams": "{teams}",
                            "timerNames": "{timerNames}",
                            "contextw": "{contextw}"
                        },
                        "args": {
                            "ts": "#Number",
                            "name": "#String",
                            "teams": "#list",
                            "timerNames": "#list",
                            "contextw": "#Number"
                        },
                        "setForceInEach": {
                            "teams": {
                                "fio": "{@userFio}",
                                "owner": "{@userLogin}",
                                "w": "{@setNewWid()}"
                            },
                            "teams[].comments": {
                                "fio": "{@userFio}",
                                "owner": "{@userLogin}",
                                "w": "{@setNewWid()}"
                            }
                        }
                    },
                    {
                        "track": [
                            [
                                "w",
                                "===",
                                "{gamew}"
                            ]
                        ],
                        "args": {
                            "gamew": "#Number"
                        },
                        "cloneArgs": {
                            "areaw": "gamew",
                            "listw": "teamw"
                        },
                        "next": [
                            {
                                "track": [
                                    "timerNames"
                                ],
                                "next": [
                                    {
                                        "level": 30,
                                        "action": "updateGameTimerNames",
                                        "method": "set",
                                        "value": "{list}",
                                        "args": {
                                            "list": "#List"
                                        }
                                    }
                                ]
                            },
                            {
                                "track": [
                                    "teams"
                                ],
                                "next": [
                                    {
                                        "level": 30,
                                        "action": "updateGameTeamList",
                                        "method": "set",
                                        "value": "{list}",
                                        "args": {
                                            "list": "#List"
                                        },
                                        "setForceInEach": {
                                            ".": {
                                                "fio": "{@userFio}",
                                                "owner": "{@userLogin}",
                                                "w": "{@setNewWid()}"
                                            },
                                            "comments": {
                                                "fio": "{@userFio}",
                                                "owner": "{@userLogin}",
                                                "w": "{@setNewWid()}"
                                            }
                                        }
                                    },
                                    {
                                        "track": [
                                            [
                                                "w",
                                                "===",
                                                "{teamw}"
                                            ]
                                        ],
                                        "args": {
                                            "teamw": "#Number"
                                        },
                                        "next": [
                                            {
                                                "track": [
                                                    "comments"
                                                ],
                                                "expected": [],
                                                "next": [
                                                    {
                                                        "action": "addCommentToGameTeam",
                                                        "method": "push",
                                                        "value": {
                                                            "w": "{@setNewWid()}",
                                                            "ts": "{ts}",
                                                            "comment": "{comment}",
                                                            "fio": "{@userFio}",
                                                            "owner": "{@userLogin}"
                                                        },
                                                        "args": {
                                                            "comment": "#String",
                                                            "ts": "#Number"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "track": [
                                                    "members"
                                                ],
                                                "args": {
                                                    "humanw": "#Number"
                                                },
                                                "next": [
                                                    {
                                                        "action": "removeMemberFromTeam",
                                                        "method": "remove",
                                                        "level": 30,
                                                        "value": [
                                                            ".",
                                                            "===",
                                                            "{humanw}"
                                                        ]
                                                    },
                                                    {
                                                        "uniqs": [
                                                            "."
                                                        ],
                                                        "level": 30,
                                                        "action": "addMemberToTeam",
                                                        "method": "push",
                                                        "value": "{humanw}"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "track": [
                                    "timers"
                                ],
                                "expected": [],
                                "next": [
                                    {
                                        "uniqs": [
                                            "ts"
                                        ],
                                        "level": 20,
                                        "action": "addGameTimer",
                                        "title": "Добавлен новый таймер $name для игры $gamen",
                                        "method": "push",
                                        "value": {
                                            "w": "{@setNewWid()}",
                                            "fio": "{@userFio}",
                                            "owner": "{@userLogin}",
                                            "ts": "{ts}",
                                            "name": "{name}",
                                            "mode": "{mode}",
                                            "joins": "{joins}",
                                            "start": "{start}",
                                            "starts": "{starts}",
                                            "teams": "{teams}",
                                            "finishes": "{finishes}",
                                            "comments": "{comments}"
                                        },
                                        "args": {
                                            "ts": "#Number",
                                            "name": "#String",
                                            "mode": "#Number",
                                            "joins": "#number",
                                            "start": "#number",
                                            "starts": "#list",
                                            "teams": "#list",
                                            "comments": "#list",
                                            "finishes": "#dict"
                                        },
                                        "setForceInEach": {
                                            "comments": {
                                                "fio": "{@userFio}",
                                                "owner": "{@userLogin}",
                                                "w": "{@setNewWid()}"
                                            }
                                        }
                                    },
                                    {
                                        "next": [
                                            {
                                                "cloneArgs": {
                                                    "listw": "timerw"
                                                },
                                                "track": [
                                                    [
                                                        "w",
                                                        "===",
                                                        "{timerw}"
                                                    ]
                                                ],
                                                "args": {
                                                    "timerw": "#Number"
                                                },
                                                "next": [
                                                    {
                                                        "track": [
                                                            "comments"
                                                        ],
                                                        "expected": [],
                                                        "action": "addCommentForGameTimer",
                                                        "method": "push",
                                                        "value": {
                                                            "w": "{@setNewWid()}",
                                                            "ts": "{ts}",
                                                            "comment": "{comment}",
                                                            "fio": "{@userFio}",
                                                            "owner": "{@userLogin}"
                                                        },
                                                        "args": {
                                                            "comment": "#String",
                                                            "ts": "#Number"
                                                        }
                                                    },
                                                    {
                                                        "track": [
                                                            "isInactive"
                                                        ],
                                                        "action": "setIsIctiveGameTimer",
                                                        "method": "set",
                                                        "args": {
                                                            "value": "#Boolean"
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "track": [
            "contexts"
        ],
        "expected": {},
        "next": [
            {
                "track": [
                    "list"
                ],
                "expected": [],
                "next": [
                    {
                        "action": "addContext",
                        "level": 30,
                        "method": "push",
                        "value": {
                            "w": "{@setNewWid()}",
                            "name": "{name}",
                            "members": "{members}",
                            "mentors": "{mentors}"
                        },
                        "args": {
                            "name": "#String",
                            "members": "#List",
                            "mentors": "#List"
                        }
                    },
                    {
                        "args": {
                            "contextw": "#Number"
                        },
                        "track": [
                            [
                                "w",
                                "===",
                                "{contextw}"
                            ]
                        ],
                        "next": [
                            {
                                "action": "addHumansToContext",
                                "track": [
                                    "{listn}"
                                ],
                                "method": "concat",
                                "uniqs": [
                                    "."
                                ],
                                "value": "{list}",
                                "args": {
                                    "list": "#List",
                                    "listn": [
                                        "mentors",
                                        "members"
                                    ]
                                }
                            },
                            {
                                "action": "removeHumansFromContext",
                                "track": [
                                    "{listn}"
                                ],
                                "method": "remove_each",
                                "uniqs": [
                                    "."
                                ],
                                "value": [
                                    ".",
                                    "in",
                                    "{list}"
                                ],
                                "args": {
                                    "list": "#List",
                                    "listn": [
                                        "mentors",
                                        "members"
                                    ]
                                }
                            },
                            {
                                "track": [
                                    "blanks"
                                ],
                                "expected": [],
                                "next": [
                                    {
                                        "level": 40,
                                        "action": "addContextGroupFieldBlanks",
                                        "method": "concat",
                                        "uniqs": [
                                            "key"
                                        ],
                                        "value": "{list}",
                                        "args": {
                                            "list": "#List"
                                        }
                                    },
                                    {
                                        "track": [
                                            [
                                                "key",
                                                "===",
                                                "{key}"
                                            ]
                                        ],
                                        "args": {
                                            "key": "#String"
                                        },
                                        "next": [
                                            {
                                                "track": [
                                                    "{fieldn}"
                                                ],
                                                "action": "setContextGroupFieldBlankField",
                                                "method": "set",
                                                "args": {
                                                    "fieldn": [
                                                        "name",
                                                        "def",
                                                        "value",
                                                        "type"
                                                    ],
                                                    "value": "#Any"
                                                }
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "track": [
                                    "groups"
                                ],
                                "expected": [],
                                "next": [
                                    {
                                        "action": "addContextGroup",
                                        "method": "push",
                                        "uniqs": [
                                            "w"
                                        ],
                                        "value": {
                                            "w": "{@setNewWid()}",
                                            "ts": "{ts}",
                                            "name": "{name}",
                                            "mentors": "{mentors}",
                                            "members": "{members}"
                                        },
                                        "args": {
                                            "ts": "#Number",
                                            "name": "#String",
                                            "members": "#List",
                                            "mentors": "#List"
                                        }
                                    },
                                    {
                                        "track": [
                                            [
                                                "w",
                                                "===",
                                                "{groupw}"
                                            ]
                                        ],
                                        "args": {
                                            "groupw": "#Number"
                                        },
                                        "next": [
                                            {
                                                "track": [
                                                    "name"
                                                ],
                                                "action": "setContextGroupName",
                                                "method": "set",
                                                "args": {
                                                    "value": "#String"
                                                }
                                            },
                                            {
                                                "track": [
                                                    "fields"
                                                ],
                                                "level": 30,
                                                "expected": {},
                                                "action": "setContextGroupFields",
                                                "method": "set_all",
                                                "args": {
                                                    "value": "#Dict"
                                                }
                                            },
                                            {
                                                "track": [
                                                    "{fieldn}"
                                                ],
                                                "args": {
                                                    "fieldn": [
                                                        "members",
                                                        "mentors"
                                                    ]
                                                },
                                                "next": [
                                                    {
                                                        "action": "addContextGroupHumans",
                                                        "method": "concat",
                                                        "uniqs": [
                                                            "."
                                                        ],
                                                        "args": {
                                                            "value": "#List"
                                                        }
                                                    },
                                                    {
                                                        "action": "delContextGroupHumans",
                                                        "method": "remove_each",
                                                        "value": [
                                                            ".",
                                                            "in",
                                                            "{value}"
                                                        ],
                                                        "args": {
                                                            "value": "#List"
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ]
    }
]